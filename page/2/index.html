<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jacob Ludriks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Jacob Ludriks">
<meta property="og:url" content="http://jacob.ludriks.com/page/2/index.html">
<meta property="og:site_name" content="Jacob Ludriks">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jacob Ludriks">
  
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jacob.ludriks.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-BitLocker-AD-ACE-s" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/04/BitLocker-AD-ACE-s/">BitLocker AD ACE&#39;s</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/06/04/BitLocker-AD-ACE-s/" class="article-date">
  <time datetime="2015-06-04T05:27:00.000Z" itemprop="datePublished">2015-06-04</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>When setting up BitLocker for interoperability with Active Directory, Microsoft gets you to run a VBS script to add an Access Control Entity (<a href="https://technet.microsoft.com/en-us/library/dd875529%28v=ws.10%29.aspx" target="_blank" rel="external">https://technet.microsoft.com/en-us/library/dd875529%28v=ws.10%29.aspx</a>). Unfortunately the script didn’t work for me, so I rewrote it in PowerShell.</p>
<script src="https://gist.github.com/jacobludriks/0bd728f35570a63b7dbf.js"></script>

<p>Use with <code>.\BitLocker-ACE.ps1 -Read</code> to check if the ACE is already there and <code>.\BitLocker-ACE.ps1 -Write</code> to create the ACE.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/activedirectory/">activedirectory</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bitlocker/">bitlocker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Trying-out-Docker-with-VMWare-Photon-and-Docker-CLI-for-Windows" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/23/Trying-out-Docker-with-VMWare-Photon-and-Docker-CLI-for-Windows/">Trying out Docker with VMWare Photon and Docker CLI for Windows</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/04/23/Trying-out-Docker-with-VMWare-Photon-and-Docker-CLI-for-Windows/" class="article-date">
  <time datetime="2015-04-23T06:30:00.000Z" itemprop="datePublished">2015-04-23</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>VMWare released “Photon” earlier this week, which is a lightweight Linux OS for hosting Docker containers. It’s amazingly slim like CoreOS and deploys in a matter of seconds. I gave it a spin today and it worked pretty well. Installing it on vSphere was pretty straightforward following <a href="https://vmware.github.io/photon/assets/files/getting_started_with_photon_on_vsphere.pdf" target="_blank" rel="external">documentation</a> on the Photon GitHub site. Once it was installed, I needed to make a few changes to get it working smoothly.</p>
<h4 id="Setting-the-proxy"><a href="#Setting-the-proxy" class="headerlink" title="Setting the proxy"></a>Setting the proxy</h4><p>If your environment uses a proxy to connect to the internet, continue with this section. If not, skip.</p>
<p>First, create a new directory to store the extra configuration.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/systemd/system/docker.service.d</div></pre></td></tr></table></figure>
<p>Next, create a <code>http-proxy.conf</code> file in the directory and edit it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">touch /etc/systemd/system/docker.service.d/http-proxy.conf</div><div class="line">nano /etc/systemd/system/docker.service.d/http-proxy.conf</div></pre></td></tr></table></figure>
<p>Add the following information to the file (substituting where necessary) and save with <code>Ctrl + X</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Service]</div><div class="line">Environment=&quot;HTTP_PROXY=http://username:password@proxy.example.com:8080/&quot;</div></pre></td></tr></table></figure>
<p>Reload the <code>systemd</code> daemon and restart Docker.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl daemon-reload</div><div class="line">systemctl restart docker</div></pre></td></tr></table></figure>
<p>Docker now has access to the internet.</p>
<h4 id="Allow-Docker-connection-via-TCP"><a href="#Allow-Docker-connection-via-TCP" class="headerlink" title="Allow Docker connection via TCP"></a>Allow Docker connection via TCP</h4><p>By default, Docker only allows connection through UNIX sockets. Since we will be controlling it via the Windows client, we need TCP access.</p>
<p>Open up the Docker service file in nano</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nano /etc/systemd/system/multi-user.target.wants/docker.service</div></pre></td></tr></table></figure>
<p>Edit the <code>Service -&gt; ExecStart</code> line to allow TCP connections by changing:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ExecStart=/bin/docker -d -s overlay</div></pre></td></tr></table></figure>
<p>to</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ExecStart=/bin/docker -d -s overlay -H tcp://0.0.0.0:2375</div></pre></td></tr></table></figure>
<p>Reload the <code>systemd</code> daemon and restart Docker.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl daemon-reload</div><div class="line">systemctl restart docker</div></pre></td></tr></table></figure>
<h4 id="Upgrade-the-Docker-binary"><a href="#Upgrade-the-Docker-binary" class="headerlink" title="Upgrade the Docker binary"></a>Upgrade the Docker binary</h4><p>Photon comes with Docker 1.5.0 but unfortunately the Windows client only works with 1.6.0 and above.</p>
<p>If you are using a corporate proxy, you will first need to set the <code>http_proxy</code> environmental variable so <code>wget</code> works</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export https_proxy=&quot;http://username:password@proxy.example.com:8080/&quot;</div></pre></td></tr></table></figure>
<p>Download the Docker 1.6.0 binary</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://get.docker.com/builds/Linux/x86_64/docker-1.6.0</div></pre></td></tr></table></figure>
<p>Move the binary to <code>/bin/</code> and mark it as executable</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">systemctl stop docker</div><div class="line">rm -r /bin/docker</div><div class="line">mv docker-1.6.0 /bin/docker</div><div class="line">chmod +x /bin/docker</div><div class="line">systemctl start docker</div></pre></td></tr></table></figure>
<p>You will now have Docker 1.6.0 running.</p>
<h4 id="Connecting-from-Windows"><a href="#Connecting-from-Windows" class="headerlink" title="Connecting from Windows"></a>Connecting from Windows</h4><p>Download Docker 1.6.0 for Windows from Docker.com - <a href="https://get.docker.com/builds/Windows/i386/docker-1.6.0.exe" target="_blank" rel="external">32-bit</a> or <a href="https://get.docker.com/builds/Windows/x86_64/docker-1.6.0.exe" target="_blank" rel="external">64-bit</a> and open PowerShell in that directory. At this point I recommend renaming the file to <code>docker.exe</code>.</p>
<p>To connect to the Photon host, run the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.\docker.exe -H=tcp://photon.ip.address.here:2375 info</div></pre></td></tr></table></figure>
<p>This will show information about the Docker host like so:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Containers: 12</div><div class="line">Images: 49</div><div class="line">Storage Driver: overlay</div><div class="line"> Backing Filesystem: extfs</div><div class="line">Execution Driver: native-0.2</div><div class="line">Kernel Version: 3.19.2</div><div class="line">Operating System: &lt;unknown&gt;</div><div class="line">CPUs: 2</div><div class="line">Total Memory: 489.7 MiB</div><div class="line">Name: bvdocker1</div><div class="line">ID: &lt;id here&gt;</div></pre></td></tr></table></figure>
<p>You are now connected!</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/photon/">photon</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/">windows</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Matching-VM-disks-and-Windows-disks-with-PowerCLI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/22/Matching-VM-disks-and-Windows-disks-with-PowerCLI/">Matching VM disks and Windows disks with PowerCLI</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/04/22/Matching-VM-disks-and-Windows-disks-with-PowerCLI/" class="article-date">
  <time datetime="2015-04-22T02:18:00.000Z" itemprop="datePublished">2015-04-22</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Tweaked from <a href="http://www.van-lieshout.com/2009/12/match-vm-and-windows-harddisks-using-powercli/" target="_blank" rel="external">http://www.van-lieshout.com/2009/12/match-vm-and-windows-harddisks-using-powercli/</a> to be more modern and with more error checking.</p>
<script src="https://gist.github.com/jacobludriks/a6356e89d54aad11cc4f.js"></script>
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powercli/">powercli</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scsi/">scsi</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Getting-Office365-license-information" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/21/Getting-Office365-license-information/">Getting Office365 license information</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/04/21/Getting-Office365-license-information/" class="article-date">
  <time datetime="2015-04-21T05:06:00.000Z" itemprop="datePublished">2015-04-21</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>A nice little one-liner. This assumes you have already ran <code>Connect-MsolService</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Get-MsolUser | select firstname,lastname,userprincipalname,islicensed,@&#123;N=&quot;License&quot;;E=&#123;switch -regex ($_.licenses.accountskuid) &#123; (&quot;ENTERPRISEPACK&quot;) &#123; &quot;E3&quot; &#125; (&quot;STANDARDPACK&quot;) &#123; &quot;E1&quot; &#125; &#125;&#125;&#125; | ft</div></pre></td></tr></table></figure>
<p>You can add more switches for more license types but we only use E3 and E1. Types are:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&quot;DESKLESSPACK&quot; = &quot;Office 365 (Plan K1)&quot;</div><div class="line">&quot;DESKLESSWOFFPACK&quot; = &quot;Office 365 (Plan K2)&quot;</div><div class="line">&quot;LITEPACK&quot; = &quot;Office 365 (Plan P1)&quot;</div><div class="line">&quot;EXCHANGESTANDARD&quot; = &quot;Office 365 Exchange Online Only&quot;</div><div class="line">&quot;STANDARDPACK&quot; = &quot;Office 365 (Plan E1)&quot;</div><div class="line">&quot;STANDARDWOFFPACK&quot; = &quot;Office 365 (Plan E2)&quot;</div><div class="line">&quot;ENTERPRISEPACK&quot; = &quot;Office 365 (Plan E3)&quot;</div><div class="line">&quot;ENTERPRISEPACKLRG&quot; = &quot;Office 365 (Plan E3)&quot;</div><div class="line">&quot;ENTERPRISEWITHSCAL&quot; = &quot;Office 365 (Plan E4)&quot;</div><div class="line">&quot;STANDARDPACK_STUDENT&quot; = &quot;Office 365 (Plan A1) for Students&quot;</div><div class="line">&quot;STANDARDWOFFPACKPACK_STUDENT&quot; = &quot;Office 365 (Plan A2) for Students&quot;</div><div class="line">&quot;ENTERPRISEPACK_STUDENT&quot; = &quot;Office 365 (Plan A3) for Students&quot;</div><div class="line">&quot;ENTERPRISEWITHSCAL_STUDENT&quot; = &quot;Office 365 (Plan A4) for Students&quot;</div><div class="line">&quot;STANDARDPACK_FACULTY&quot; = &quot;Office 365 (Plan A1) for Faculty&quot;</div><div class="line">&quot;STANDARDWOFFPACKPACK_FACULTY&quot; = &quot;Office 365 (Plan A2) for Faculty&quot;</div><div class="line">&quot;ENTERPRISEPACK_FACULTY&quot; = &quot;Office 365 (Plan A3) for Faculty&quot;</div><div class="line">&quot;ENTERPRISEWITHSCAL_FACULTY&quot; = &quot;Office 365 (Plan A4) for Faculty&quot;</div><div class="line">&quot;ENTERPRISEPACK_B_PILOT&quot; = &quot;Office 365 (Enterprise Preview)&quot;</div><div class="line">&quot;STANDARD_B_PILOT&quot; = &quot;Office 365 (Small Business Preview)&quot;</div></pre></td></tr></table></figure>
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/office365/">office365</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oneliner/">oneliner</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Deploying-Node-js-with-Powershell-DSC" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/20/Deploying-Node-js-with-Powershell-DSC/">Deploying Node.js with Powershell DSC</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/04/20/Deploying-Node-js-with-Powershell-DSC/" class="article-date">
  <time datetime="2015-04-20T05:06:00.000Z" itemprop="datePublished">2015-04-20</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>As the title says, a DSC file for Node.js. This also changes the global node_modules directory to something accessibly by all users.</p>
<script src="https://gist.github.com/jacobludriks/f163880aa27c78efe8a6.js"></script>

<p>Enjoy.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsc/">dsc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Email2SMS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/11/Email2SMS/">Email2SMS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/02/11/Email2SMS/" class="article-date">
  <time datetime="2015-02-11T06:27:00.000Z" itemprop="datePublished">2015-02-11</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>We’ve switched SMS providers at work to <a href="http://www.nexmo.com" target="_blank" rel="external">Nexmo</a>, however they don’t have a SMTP API. I whipped up a quick EWS script to monitor a mailbox for emails in the correct format and to send SMS’ based off it. Script below.</p>
<script src="https://gist.github.com/jacobludriks/849ed52a7987e407cc2d.js"></script>

<p>The script should be run as the user whos mailbox will be monitored (ours is set up as a scheduled task). Next, it should have to subfolders called “Error” and “Processed”. Successful emails get marked as read and send to “Processed”, and unsuccessful emails get kept as unread and moved to “Error”. Because we send from some systems that don’t have SMTP authentication, there is a field called “Secret” that should be defined at the top of the PowerShell script and put in each email.</p>
<p>The format for the email is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">From: fromuser</div><div class="line">To: number in international format (ie. +61404040404)</div><div class="line">Text: any text here</div><div class="line">Secret: secret code defined in script</div></pre></td></tr></table></figure>
<p>The script is set to run every 20 seconds.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sms/">sms</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Send-NexmoSMS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/11/Send-NexmoSMS/">Send-NexmoSMS</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/02/11/Send-NexmoSMS/" class="article-date">
  <time datetime="2015-02-11T01:17:00.000Z" itemprop="datePublished">2015-02-11</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>A simple Powershell function to send a SMS through the <a href="http://www.nexmo.com" target="_blank" rel="external">Nexmo</a> API. Enjoy.</p>
<script src="https://gist.github.com/jacobludriks/a9fa14f95038e3b41952.js"></script>
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sms/">sms</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Connecting-to-vSphere-consoles-with-VMware-Player" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/06/Connecting-to-vSphere-consoles-with-VMware-Player/">Connecting to vSphere consoles with VMware Player</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/02/06/Connecting-to-vSphere-consoles-with-VMware-Player/" class="article-date">
  <time datetime="2015-02-06T00:48:00.000Z" itemprop="datePublished">2015-02-06</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>This isn’t really documented anywhere on the VMware website, but it comes in really handy if require certain users to have console access to machines without the complication of the vSphere Web Client.</p>
<ul>
<li><p>Install VMware Player from the <a href="https://my.vmware.com/web/vmware/downloads" target="_blank" rel="external">VMware website</a></p>
</li>
<li><p>Get the Managed Object ID of the VM. This can be done through PowerCLI with the following script:</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$vcenter = &quot;vcenter.domain.name&quot;</div><div class="line">$targetvm = &quot;targetvm&quot;</div><div class="line"></div><div class="line">Add-PSSnapin VMware.VimAutomation.Core</div><div class="line">Connect-VIServer -Server $vcenter -Force</div><div class="line">$vmid = (Get-VM $targetvm).id -replace &quot;VirtualMachine-&quot;,&quot;&quot;</div><div class="line">Disconnect-VIServer -Server $vcenter -Confirm:$false</div><div class="line"></div><div class="line">Write-Output &quot;VM MOID is $vmid&quot;</div></pre></td></tr></table></figure>
<ul>
<li><p>Give the user access to the VM. The permission “Virtual Machine\Interaction\Console Interation” needs to be given on both the VM and the host. It doesn’t need to inherit to children so deselect “Propagate to children” in the permisisons screen”.</p>
</li>
<li><p>Create a shortcut to connect straight to the VM. The following PowerShell script can create the shortcut automatically.</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$desktop = [Environment]::GetFolderPath(&quot;Desktop&quot;)</div><div class="line">$vcenter = &quot;vcenter.domain.name&quot;</div><div class="line">$targetvm = &quot;targetvm&quot;</div><div class="line">$vmid = &quot;vm-moid&quot;</div><div class="line"></div><div class="line">$WshShell = New-Object -comObject WScript.Shell</div><div class="line">$Shortcut = $WshShell.CreateShortcut(&quot;$desktop\$targetvm.lnk&quot;)</div><div class="line">$Shortcut.TargetPath = &quot;vmrc://$vcenter/?moid=$vmid&quot;</div><div class="line">$Shortcut.Save()</div></pre></td></tr></table></figure>
<p>Afterwards, double click on the shortcut on the desktop and enter appropriate credentials. You’ll be straight in to the console.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powercli/">powercli</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/">vmware</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Installing-Pydio-through-Powershell-DSC" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/05/Installing-Pydio-through-Powershell-DSC/">Installing Pydio through Powershell DSC</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/02/05/Installing-Pydio-through-Powershell-DSC/" class="article-date">
  <time datetime="2015-02-05T04:00:00.000Z" itemprop="datePublished">2015-02-05</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Powershell Desired State Configuration (DSC) is relatively new but wow, it is so powerful! I’ve had troubles getting Pydio up and running in the past, so I created a consistent configuration file to get it working.</p>
<script src="https://gist.github.com/jacobludriks/e22bb0f31b6d949c0655.js"></script>

<p>Simply save the file as pydio.ps1 and run it on the target server. Make sure to download the prerequisite files (PHP, VC++ 2012 Redistributable, PHP Manager for IIS) and put them in an accessible location.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsc/">dsc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pydio/">pydio</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Updating-iLO3-through-SSH" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/01/22/Updating-iLO3-through-SSH/">Updating iLO3 through SSH</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/01/22/Updating-iLO3-through-SSH/" class="article-date">
  <time datetime="2015-01-21T23:47:00.000Z" itemprop="datePublished">2015-01-22</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>The iLO interface on one of our servers complete broke and we had no way of accessing it, and it wasn’t updating through the HP SPP media. Fortunately I was able to update it through SSH.</p>
<p>However, because the firmware on the iLO interface was so old, it needed to be upgraded to an earlier version first before updating to the latest. This is documented on the <a href="http://h20564.www2.hp.com/hpsc/doc/public/display?docId=mmr_kc-0107776" target="_blank" rel="external">HP Support Centre</a>.</p>
<p>Download a iLO3 1.2x firmware. It will come with the filename <code>ilo3_12x.bin</code>, with x being the minor version number. Upload the file to a web server that can be accessed by the iLO interface. Now, open a SSH session and connect to the iLO IP address. Run the following commands, replacing <code>webserver</code> with your web server FQDN/IP and the filename with the file you downloaded:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd map1/firmware1</div><div class="line">load -source http://webserver/ilo3_12x.bin</div></pre></td></tr></table></figure>
<p>The iLO will now update and reboot, disconnecting you from SSH in the process. Once it’s back up, it will be upgraded and ready for the final upgrade through the HP SPP.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hp/">hp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ilo/">ilo</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
      </nav>
    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Jacob Ludriks&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>



<script src="/js/script.js"></script>
  </div>
</body>
</html>