<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jacob Ludriks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Jacob Ludriks">
<meta property="og:url" content="http://jacob.ludriks.com/page/3/index.html">
<meta property="og:site_name" content="Jacob Ludriks">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jacob Ludriks">
<meta name="twitter:description">
  
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jacob.ludriks.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-vSphere-multipathing-report" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/01/13/vSphere-multipathing-report/">vSphere multipathing report</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/01/13/vSphere-multipathing-report/" class="article-date">
  <time datetime="2015-01-13T03:39:00.000Z" itemprop="datePublished">2015-01-13</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>The following script generates a report of all datastores and their multipathing policy. This was extremely useful when fixing up some datastores to use best practices with our 3PAR systems.</p>
<script src="https://gist.github.com/jacobludriks/02d2abf36f2670534e12.js"></script>

<p>Run with:</p>
<p><em>.\multipathing.ps1 -vCenter vcenter.domain.com -VMHost esxi.domain.com</em></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/esxi/">esxi</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powercli/">powercli</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/">vmware</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Upgrading-HBA-Firmware-and-Drivers-on-HP-ESXi-Hosts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/27/Upgrading-HBA-Firmware-and-Drivers-on-HP-ESXi-Hosts/">Upgrading HBA Firmware and Drivers on HP ESXi Hosts</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/11/27/Upgrading-HBA-Firmware-and-Drivers-on-HP-ESXi-Hosts/" class="article-date">
  <time datetime="2014-11-27T11:37:00.000Z" itemprop="datePublished">2014-11-27</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’m guilty of only updating firmware and drivers on my devices when problems arise. I’m sure most of us do this. Bad practice! The guide in this post shows how to update a ProLiant system (blade, pedestal or rackmount) with the HP SPP and latest drivers.</p>
<p><strong>BEFORE YOU DO ANYTHING</strong>: Put the host in maintenance mode and move the virtual machines off! This probably doesn’t need to be said, but hey.</p>
<p><a href="http://vibsdepot.hp.com/" target="_blank" rel="external">HP VibsDepot</a> is a great resource for the currently supported firmware and driver recipe for ESXi as well as links to the required files. The most current support recipe document is located at <a href="http://vibsdepot.hp.com/hpq/recipes/HP-VMware-Recipe.pdf" target="_blank" rel="external">http://vibsdepot.hp.com/hpq/recipes/HP-VMware-Recipe.pdf</a> (pdf). First things first; you need to get the model of your HBA and which driver it uses. You can do this by connecting to the host with SSH.</p>
<p>If you don’t have SSH enabled, press F2 at the ESXi screen and login with the root credentials. Then, go down to <code>Troubleshooting Options</code> and select <code>Enable SSH</code>. You can then exit out of the menu by hitting the escape key a few times.</p>
<p>Open up your SSH client and connect to the host, then:</p>
<p><code># ls /proc/scsi</code></p>
<p>You will see possibly two or three devices. My HBA’s are Emulex branded, so mine shows as <code>lpfc820</code>.</p>
<p><code># cat /proc/scsi/lpfc820/1</code></p>
<p>I used tab complete after the final slash to get the HBA number put in automatically. The info received:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Emulex OneConnect FCoE SCSI 8.2.1.90.28</span><br><span class="line">HP FlexFabric 10Gb 2-port 554FLB Adapter on PCI bus 0000:04 device 02 irq 184 Logical Link Speed: 4000 Mbps</span><br><span class="line">BoardNum: 0</span><br><span class="line">ESX Adapter: vmhba0</span><br><span class="line">Firmware Version: 4.1.450.16</span><br><span class="line">Portname: 50:06:0b:00:00:c2:62:10   Nodename: 50:06:0b:00:00:c2:62:11</span><br><span class="line">SLI Rev: 4</span><br><span class="line">    MQ: Enabled with 0x2 queues</span><br><span class="line">    NPIV Supported: VPIs max 255  VPIs used 0</span><br><span class="line">    RPIs max 1024  RPIs used 4   IOCBs inuse 0  IOCB max 8   txq cnt 0  txq max 0  txcmplq 0</span><br><span class="line">    Vport List:</span><br><span class="line">Link Up - Ready:</span><br><span class="line">    PortID 0x10e05</span><br><span class="line">    Fabric</span><br><span class="line">    Current speed 10G</span><br><span class="line">Port Discovered Nodes: Count 2</span><br><span class="line">t0000 DID 010c00 WWPN 50:01:43:80:02:5d:bb:e8 WWNN 50:01:43:80:02:5d:bb:e0 qdepth 8192 max 2 active 0 busy 0</span><br><span class="line">t0001 DID 010d00 WWPN 50:01:43:80:02:5d:bb:ec WWNN 50:01:43:80:02:5d:bb:e0 qdepth 8192 max 2 active 0 busy 0</span><br></pre></td></tr></table></figure>
<p>The most relevant information above is that the driver version currently installed is <code>8.2.1.90.28</code>, the firmware version is <code>4.1.450.16</code> and that the card is a <code>HP FlexFabric 10Gb 2-port 554FLB</code>. Within the recipe PDF linked to earlier, I can see that the most recent driver version is <code>8.2.4.141.55</code> and the most recent firmware version is <code>4.2.401.2215</code>, so I’m behind quite a few versions.</p>
<p>From the recipe PDF, click on the required driver link for your card, which will take you to the VMWare website. A zip file will be downloaded, and inside is another zip file with the word <strong>offline_bundle</strong> in its filename. This is the driver package we need. Set it aside for the next step. For the firmware, download the latest <a href="http://h18004.www1.hp.com/products/servers/service_packs/en/index.html" target="_blank" rel="external">Service Pack for ProLiant</a>. It’s a big ISO that includes firmware updates for all ProLiant servers and it works quite well. It’s normally updated every 3-4 months.</p>
<p>If you’re like me and have some old blades in your environment (like the BL460c G1) with iLO 2, you might find the virtual media function a bit flaky when you mount the SPP ISO. As a workaround, use the <a href="http://h20565.www2.hp.com/portal/site/hpsc/template.PAGE/public/psi/swdDetails/?javax.portlet.begCacheTok=com.vignette.cachetoken&amp;javax.portlet.endCacheTok=com.vignette.cachetoken&amp;javax.portlet.prp_bd9b6997fbc7fc515f4cf4626f5c8d01=wsrp-navigationalState%3Didx%3D%7CswItem%3DMTX_40e268a99cc243a299352b7b20%7CitemLocale%3D%7Cmode%3D%7Caction%3DdriverDocument&amp;javax.portlet.tpst=bd9b6997fbc7fc515f4cf4626f5c8d01&amp;ac.admitted=1374043405767.876444892.492883150" target="_blank" rel="external">HP USB Key Utility</a> (version 1.7!) to put the SPP on a USB drive and use a direct connection to the blade to boot. Don’t forget, the boot menu key is <strong>F11</strong>.</p>
<p>There is some excellent documentation available on the <a href="http://h18004.www1.hp.com/products/servers/service_packs/en/index.html" target="_blank" rel="external">HP SPP portal</a> for how to use the SPP. The latest version from when this post was written is <a href="http://bizsupport2.austin.hp.com/bc/docs/support/SupportManual/c03673114/c03673114.pdf" target="_blank" rel="external">here</a>.</p>
<p>Use an SCP client (I use <a href="http://winscp.net/" target="_blank" rel="external">WinSCP</a>) to transfer the offline_bundle driver to a temporary directory on the host (I use <code>/var/log/vmware/</code>). Then, SSH in to the host and execute the following command:</p>
<p><code># esxcli software vib install --maintenance-mode --no-sig-check -d /var/log/vmware/name_of_offline_bundle.zip</code></p>
<p>Be aware that this can take quite a while, so don’t worry if there is still no output after 10 minutes. You should get an output similar to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Installation Result</span><br><span class="line">    Message: The update completed successfully, but the system needs to be rebooted for the changes to be effective.</span><br><span class="line">    Reboot Required: true</span><br><span class="line">    VIBs Installed: Emulex_bootbank_scsi-lpfc820_8.2.4.151.65-1OEM.500.0.0.472560</span><br><span class="line">    VIBs Removed: Emulex_bootbank_scsi-lpfc820_8.2.4.141.55-1OEM.500.0.0.472560</span><br><span class="line">    VIBs Skipped:</span><br></pre></td></tr></table></figure>
<p>Issue a reboot to the system with <code>reboot</code>. Once it comes back up, take it out of maintenance mode. Done!</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/firmware/">firmware</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hp/">hp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/patches/">patches</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Lost-Management-Interface-on-an-ESXi-Host" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/27/Lost-Management-Interface-on-an-ESXi-Host/">Lost Management Interface on an ESXi Host</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/11/27/Lost-Management-Interface-on-an-ESXi-Host/" class="article-date">
  <time datetime="2014-11-27T11:32:00.000Z" itemprop="datePublished">2014-11-27</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>A hosts management network interface somehow dropped off the network this afternoon. Fortunately I was still able to get in through iLO. It always pays to have an out-of-band interface active!</p>
<img src="/2014/11/27/Lost-Management-Interface-on-an-ESXi-Host/esxi-no-mgmt.png" alt="esxi-no-mgmt.png" title="">
<p>From the DCUI screen, press <code>Alt + F1</code>. This will bring up the login screen. Log in as root then type <code>esxcli network ip interface list</code>. You will get an output similar to the one below.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">vmk2</span><br><span class="line">    Name: vmk2</span><br><span class="line">    MAC Address: 00:50:56:79:0c:de</span><br><span class="line">    Enabled: true</span><br><span class="line">    Portset: DvsPortset-0</span><br><span class="line">    Portgroup: N/A</span><br><span class="line">    VDS Name: dvSwitch-vMotion</span><br><span class="line">    VDS UUID: 0c 7d 1a 50 93 7b 86 3f-76 f8 74 80 73 7c 3d 0f</span><br><span class="line">    VDS Port: 101</span><br><span class="line">    VDS Connection: 1952632411</span><br><span class="line">    MTU: 1500</span><br><span class="line">    TSO MSS: 65535</span><br><span class="line">    Port ID: 33554436</span><br><span class="line"></span><br><span class="line">vmk0</span><br><span class="line">    Name: vmk0</span><br><span class="line">    MAC Address: 00:1c:c4:bd:d6:ee</span><br><span class="line">    Enabled: false</span><br><span class="line">    Portset: DvsPortset-2</span><br><span class="line">    Portgroup: N/A</span><br><span class="line">    VDS Name: dvSwitch</span><br><span class="line">    VDS UUID: 10 e1 1a 50 b1 22 19 a1-d4 33 10 dc 72 9a 92 db</span><br><span class="line">    VDS Port: 151</span><br><span class="line">    VDS Connection: 660732515</span><br><span class="line">    MTU: 1500</span><br><span class="line">    TSO MSS: 65535</span><br><span class="line">    Port ID: 67108871</span><br></pre></td></tr></table></figure>
<p>Fortunately mine was an easy issue to solve; vmk0 had <code>Enabled: false</code>. An easy fix: <code>esxcli network ip interface set -i vmk0 -e true</code></p>
<p>After this I was able to reconnect to the host from within vCenter.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/esxi/">esxi</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/">vmware</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Meeting-Room-Utilization" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/27/Meeting-Room-Utilization/">Meeting Room Utilization</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/11/27/Meeting-Room-Utilization/" class="article-date">
  <time datetime="2014-11-27T11:30:00.000Z" itemprop="datePublished">2014-11-27</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>I had a request from a user to find out the meeting room utilization across our head office, but unfortunately I couldn’t find an easy way to do this with Exchange 2010 cmdlets. Here are some instructions to do so with COM objects, PowerShell and Excel.</p>
<p>First create a mailbox that will have the meeting room rights assigned to it, then grant the user access to the required mailboxes so that they show in Outlook:</p>
<p><code>Get-Mailbox meetingroomprefix* | Add-MailboxPermission -AccessRights FullAccess -User temporarymailbox</code></p>
<p>Open Outlook and add the meeting room mailboxes, then run the PowerShell script below with the appropriate date range. Mine shows the last financial year.</p>
<script src="https://gist.github.com/jacobludriks/8cdd5c2a74d70fd35b3b.js"></script>

<p>Next, open the CSV output file in Excel then:</p>
<ol>
<li>Create new sheet called Report</li>
<li>Insert a pivot table containing all the data from the raw data sheet</li>
<li>Drag “MeetingRoom” to Rows</li>
<li>Drag “Duration” to Values. Edit the field settings to be “Count” and rename to “Number of Meetings”</li>
<li>Drag “Duration” to Values. Edit the field settings to be “Sum” and rename to “Total Duration”</li>
<li>Create two new fields – one with the amount of work weeks per year (48.775 for mine) and the amount of hours per week (40 for mine).</li>
<li>Create a new table for utilization percentages. Put the formula as <code>=C5/($E$5*$E$9*60)</code>.</li>
</ol>
<img src="/2014/11/27/Meeting-Room-Utilization/meetingroom.png" alt="meetingroom.png" title="">
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exchange/">exchange</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Change-SMTP-settings-on-Xerox-machines-with-PowerShell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/27/Change-SMTP-settings-on-Xerox-machines-with-PowerShell/">Change SMTP settings on Xerox machines with PowerShell</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/11/27/Change-SMTP-settings-on-Xerox-machines-with-PowerShell/" class="article-date">
  <time datetime="2014-11-27T03:36:00.000Z" itemprop="datePublished">2014-11-27</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>I got really sick of changing SMTP settings on Xerox machines manually, so I made a PowerShell script to make it easier. The script can also pull a list of printers from a print server and work from that.</p>
<script src="https://gist.github.com/jacobludriks/4bcbcc9cba061f1e09a7.js"></script>

<p>Just change the variables up the top and run the script.</p>
<p>It could be further optimized with PowerShell workflows so it works on each concurrently, but I was lazy.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xerox/">xerox</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Adobe-FTP-is-slow" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/14/Adobe-FTP-is-slow/">Adobe FTP is slow!</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/08/14/Adobe-FTP-is-slow/" class="article-date">
  <time datetime="2014-08-14T04:41:00.000Z" itemprop="datePublished">2014-08-14</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Not sure if you have tried to download from adobe FTP site lately, however it is exceedingly slow (23kbps slow!). I have this afternoon, just worked out a small hack that makes it a lot faster… so far it seems to work (for the three adobe reader patches I’ve tried anyway).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. Find the file on ftp://ftp.adobe.com/</span><br><span class="line">2. Copy the url of the file (including the exe, zip, etc) that you want to download.</span><br><span class="line">3. Replace the first part of the URL (ftp://ftp.adobe.com/) with http://ardownload.adobe.com/</span><br><span class="line">E.g. ftp://ftp.adobe.com/pub/adobe/reader/win/11.x/11.0.07/misc/AdbeRdrUpd11007_incr.msp becomes http://ardownload.adobe.com/pub/adobe/reader/win/11.x/11.0.07/misc/AdbeRdrUpd11007_incr.msp </span><br><span class="line">5. Enjoy the much faster download speeds!</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/adobe/">adobe</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ftp/">ftp</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Citrix-error-number-2320" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/14/Citrix-error-number-2320/">Citrix error number 2320</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/08/14/Citrix-error-number-2320/" class="article-date">
  <time datetime="2014-08-14T04:38:00.000Z" itemprop="datePublished">2014-08-14</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>I found a weird error in Citrix the other day.</p>
<img src="/2014/08/14/Citrix-error-number-2320/citrix_online.png" alt="citrix_online.png" title="">
<p>The fix:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Citrix\ICA Client\Engine\Lockdown Profiles\All Regions</span><br><span class="line"></span><br><span class="line">Change the DWORD value for EnableLockdown from 1 to 0.</span><br><span class="line"></span><br><span class="line">Close Registry Editor and try to launch the application again.</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/citrix/">citrix</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Enable-Disable-IE-on-Server-2008R2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/31/Enable-Disable-IE-on-Server-2008R2/">Enable/Disable IE on Server 2008R2</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/07/31/Enable-Disable-IE-on-Server-2008R2/" class="article-date">
  <time datetime="2014-07-31T04:05:00.000Z" itemprop="datePublished">2014-07-31</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>To install (requires a restart):</p>
<p><code>dism /online /Enable-Feature /FeatureName:Internet-Explorer-Optional-amd64</code></p>
<p>To uninstall (doesn’t require a restart):</p>
<p><code>dism /online /Disable-Feature /FeatureName:Internet-Explorer-Optional-amd64</code></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/internetexplorer/">internetexplorer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/">windows</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Sign-PSScript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/24/Sign-PSScript/">Sign-PSScript</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/07/24/Sign-PSScript/" class="article-date">
  <time datetime="2014-07-24T00:28:00.000Z" itemprop="datePublished">2014-07-24</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Just a quick function to sign PowerShell scripts with a code-signing certificate. Very useful for deploying scripts in a domain to all computers without changing the execution policy.</p>
<script src="https://gist.github.com/jacobludriks/efc67998d8e058af76e7.js"></script>

<p>Throw it in your <code>$profile</code>, reload, run with <code>Sign-PSScript -Script c:\path\to\script.ps1</code>.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-ERROR-FILE-SYSTEM-LIMITATION-whilst-using-Windows-deduplication-with-Veeam" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/23/ERROR-FILE-SYSTEM-LIMITATION-whilst-using-Windows-deduplication-with-Veeam/">ERROR_FILE_SYSTEM_LIMITATION whilst using Windows deduplication with Veeam</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2014/07/23/ERROR-FILE-SYSTEM-LIMITATION-whilst-using-Windows-deduplication-with-Veeam/" class="article-date">
  <time datetime="2014-07-23T03:12:00.000Z" itemprop="datePublished">2014-07-23</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>This is a possible scenario that can happen with Veeam and Server 2012 deduplication:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You cannot write to a file anymore and you get the error &quot;ERROR_FILE_SYSTEM_LIMITATION&quot;. There is still plenty of space left on the volume however this file can&apos;t grow. This is a big issue wince you use rollback chains in Veeam.</span><br></pre></td></tr></table></figure>
<p>To fix this unfortunately you need to start a whole new chain on a new volume. When formatting the volume, use <code>format drive: /fs:ntfs /v:volumelabel /Q /L</code>. The <code>/Q</code> switch does a quick format, and the <code>/L</code> switch enables large-size file records.</p>
<p>Unfortunately this switch isn’t very well documented - it’s not even in the <code>format.exe</code> <a href="http://technet.microsoft.com/en-us/library/cc730730.aspx" target="_blank" rel="external">knowledgebase article</a>. You can however get some information from <code>format /?</code> in command prompt.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/L	NTFS Only: Use large size file records.</span><br><span class="line">	By default, the volume will be formatted with small size file records.</span><br></pre></td></tr></table></figure>
<p>A Microsoft primer on how NTFS works (<a href="http://technet.microsoft.com/en-us/library/cc781134(v=ws.10" target="_blank" rel="external">Source</a>.aspx)) sheds some light but it doesn’t show you the limit of setting large-size file records.</p>
<p>Reference: <a href="http://support.microsoft.com/kb/2891967" target="_blank" rel="external">Microsoft KB2891967</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deduplication/">deduplication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/veeam/">veeam</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/">windows</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
      </nav>
    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Jacob Ludriks&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>



<script src="/js/script.js"></script>
  </div>
</body>
</html>