
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jacob Ludriks">
    <title>Archives: 2014 - Jacob Ludriks</title>
    <meta name="author" content="Jacob Ludriks">
    
    
    
    <meta property="og:type" content="blog">
<meta property="og:title" content="Jacob Ludriks">
<meta property="og:url" content="http://jacob.ludriks.com/archives/2014/page/2/index.html">
<meta property="og:site_name" content="Jacob Ludriks">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jacob Ludriks">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-nuvue6sithwirecbhvw3dkaobiojqvtadsnhguwi7k04xklybw5djl1smadp.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">Jacob Ludriks</a>
    </h1>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link st-search-show-outputs"
                         href="#search"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">Search</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    

<section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/07/03/Monitoring-vSphere-folder-inventories/">
                            Monitoring vSphere folder inventories
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-07-03T16:36:00+10:00">
	
		    Jul 03, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>Backups in my work environment are done on the folder level through Veeam (excellent product), and sometimes virtual machines are moved around and get loosed from backups without us noticing. This little script monitors the folder and alerts on any changes when combined with Task Scheduler.</p>
<script src="https://gist.github.com/jacobludriks/c6550276db05fc3a7991.js"></script>

<p>A few things:</p>
<ul>
<li>Make sure the account you run it under can send email</li>
<li>Make sure the account has vSphere read permissions</li>
</ul>
<p>Enjoy.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/07/03/Monitoring-vSphere-folder-inventories/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/06/25/Get-MailboxSizes/">
                            Get-MailboxSizes
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-06-25T10:02:00+10:00">
	
		    Jun 25, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>This script produces a simple report to get the mailbox, archive and total sizes in a mailbox database. This helps with estimating space needed for mailbox moves.</p>
<script src="https://gist.github.com/jacobludriks/b095e2be224aa707145b.js"></script>

<p>To use, just load it up then use <code>Get-MailboxSizes -Database DBName</code>.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/06/25/Get-MailboxSizes/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/06/06/Getting-mailbox-database-sizes/">
                            Getting mailbox database sizes
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-06-06T17:54:00+10:00">
	
		    Jun 06, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>I’m not too sure why this isn’t exposed through the Exchange cmdlets, but here we go.</p>
<script src="https://gist.github.com/jacobludriks/b35790b4fef45ad11b21.js"></script>

<p>Run with <code>Get-DatabaseSize -Database DatabaseName</code> and it will return the database name, server, and database size in megabytes.</p>
<p>EDIT: well, it turns out you can just use <code>Get-MailboxDatabase -Database DatabaseName -Status | select name,server,databasesize</code>. Rookie error on my part.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/06/06/Getting-mailbox-database-sizes/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/06/02/meetingroomhud/">
                            meetingroomhud
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-06-02T14:20:00+10:00">
	
		    Jun 02, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>I’ve just pushed a little project to GitHub. It uses Powershell, Exchange EWS API and D3 to make a little timeline of calendar appointments for meeting rooms.</p>
<p><a href="https://github.com/jacobludriks/meetingroomhud" target="_blank" rel="external">https://github.com/jacobludriks/meetingroomhud</a></p>
<p>Feel free to give it a try and see if you hit any bugs.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/06/02/meetingroomhud/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/27/Getting-Kerberos-token-size-with-Powershell/">
                            Getting Kerberos token size with Powershell
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-27T09:25:00+10:00">
	
		    May 27, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>I ran in to an issue with a user getting a 400 error on an IIS server. Turns out it was related to a large Kerberos token size due to being in too many groups. Here is a little script to enumerate the information you need to determine the token size:</p>
<script src="https://gist.github.com/jacobludriks/d69abf71597f7aaf4167.js"></script>

<p>This is all outlined in <a href="http://support.microsoft.com/kb/327825" target="_blank" rel="external">Microsoft KB327825</a> and relates to <a href="http://support.microsoft.com/kb/2020943" target="_blank" rel="external">Microsoft KB2020943</a>.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/27/Getting-Kerberos-token-size-with-Powershell/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/21/Downloading-from-YouTube-using-Powershell/">
                            Downloading from YouTube using Powershell
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-21T13:32:00+10:00">
	
		    May 21, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p><strong>EDIT:</strong> As of 12/05/2016 this no longer works. Please use youtube-dl.exe as an alternative.</p>
<p>Sometimes when I’m travelling I don’t have internet access and I want to take videos with me. Here is a script to download videos from Youtube using Powershell.</p>
<script src="https://gist.github.com/jacobludriks/d1804f4e906b266251cd.js"></script>

<p>Run the script with <code>.\youtube.ps1 -video https://www.youtube.com/watch?v=videolink</code>. It will ask which quality you want to download in first and then download it to the current directory.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/21/Downloading-from-YouTube-using-Powershell/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/12/Member-count-of-distribution-lists/">
                            Member count of distribution lists
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-12T14:03:00+10:00">
	
		    May 12, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>I am looking at enabling certain features of mailing lists depending on how many users there are. The following script generates this report with group recursion.</p>
<script src="https://gist.github.com/jacobludriks/ceb99cdfaf6bb427d3d6.js"></script>

<p>By default it outputs to grouplisting.csv in the same folder you run the script from.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/12/Member-count-of-distribution-lists/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/12/Disabling-calendar-and-tasks-archiving-in-Exchange-2013/">
                            Disabling calendar and tasks archiving in Exchange 2013
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-12T11:49:00+10:00">
	
		    May 12, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>In our Exchange 2013 environment we have a few users who have tasks that can occur once every 5-10 years. Unfortunately this doesn’t sit well with our retention policies and they get moved down to the archive mailbox. To disable them from getting archived, create a DWORD Value in <code>HKLM\SYSTEM\CurrentControlSet\Services\MSExchangeMailboxAssistants\Parameters</code> called <code>ELCAssistantCalendarTaskRetentionEnabled</code> and make sure it is set to <code>0</code>.</p>
<p>Restart the <code>MSExchangeMailboxAssistants</code> service after making this change.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/12/Disabling-calendar-and-tasks-archiving-in-Exchange-2013/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/06/Synology-update-URLs/">
                            Synology update URLs
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-06T15:09:00+10:00">
	
		    May 06, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>If you have a restrictive firewall, Synology devices need two URLs allowed outbound to update:</p>
<ul>
<li><code>download.synology.com</code></li>
<li><code>update.synology.com</code></li>
</ul>
<p>I couldn’t really find this information anywhere else, so here you go.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/06/Synology-update-URLs/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/05/Setting-WMI-permissions-for-PRTG/">
                            Setting WMI permissions for PRTG
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-05T13:32:00+10:00">
	
		    May 05, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <p>Setting permissions for PRTG to monitor WMI on systems is a bit of a chore. The script below sets the appropriate permissions for a lot of the WMI sensors in PRTG.</p>
<script src="https://gist.github.com/jacobludriks/2fa223ac279e0472df47.js"></script>

<p>Run by using <code>script.ps1 -Username &quot;domain\user&quot;</code></p>
<p>Please note that this needs ntrights.exe, which is included in the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=17657" target="_blank" rel="external">Windows Server 2003 Resource Kit</a></p>
<p>I may look in to making this a group policy script in the future but for starters this will do. It saves around 3-5 minutes of time per server, depending how fast you can click.</p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/05/Setting-WMI-permissions-for-PRTG/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        <li class="pagination-prev">
            
                <a class="btn btn--default btn--small" href="/ ">
            
                <i class="fa fa-angle-left text-base icon-mr"></i>
                    <span>NEWER POSTS</span>
            </a>
        </li>
        
        
        <li class="pagination-next">
            <a class="btn btn--default btn--small" href="/archives/2014/page/3/">
                    <span>OLDER POSTS</span>
                <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
        </li>
        
        <li class="pagination-number">page 2 of 3</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 Jacob Ludriks. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <h4 id="about-card-name">Jacob Ludriks</h4>
        
            <h5 id="about-card-bio"><p>author.bio</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </h5>
        
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script-i4qo6jx6jji9fg0dftpya6ivemizsbow4fhow76d8dwpm7m1wbvi378ssumx.min.js"></script>
<!--SCRIPTS END-->



</html>
