
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jacob Ludriks">
    <title>Tag: exchange - Jacob Ludriks</title>
    <meta name="author" content="Jacob Ludriks">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Jacob Ludriks">
<meta property="og:url" content="http://jacob.ludriks.com/tags/exchange/index.html">
<meta property="og:site_name" content="Jacob Ludriks">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jacob Ludriks">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-3frockyt2j28isvdztjchy5nhkz8tjki9ermufc1ckptmvjdftux94m2ahub.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Jacob Ludriks</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://stackoverflow.com/users" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://plus.google.com/" target="_blank" rel="noopener" title="Google +">
                    
                        <i class="sidebar-button-icon fab fa-google-plus" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google +</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/profile/" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/mailto"
                            title="Mail"
                        >
                    
                        <i class="sidebar-button-icon fab fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/11/27/Meeting-Room-Utilization/">
                            Meeting Room Utilization
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-11-27T22:30:00+11:00">
	
		    Nov 27, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>I had a request from a user to find out the meeting room utilization across our head office, but unfortunately I couldn’t find an easy way to do this with Exchange 2010 cmdlets. Here are some instructions to do so with COM objects, PowerShell and Excel.</p>
<p>First create a mailbox that will have the meeting room rights assigned to it, then grant the user access to the required mailboxes so that they show in Outlook:</p>
<p><code>Get-Mailbox meetingroomprefix* | Add-MailboxPermission -AccessRights FullAccess -User temporarymailbox</code></p>
<p>Open Outlook and add the meeting room mailboxes, then run the PowerShell script below with the appropriate date range. Mine shows the last financial year.</p>
<script src="https://gist.github.com/jacobludriks/8cdd5c2a74d70fd35b3b.js"></script>

<p>Next, open the CSV output file in Excel then:</p>
<ol>
<li>Create new sheet called Report</li>
<li>Insert a pivot table containing all the data from the raw data sheet</li>
<li>Drag “MeetingRoom” to Rows</li>
<li>Drag “Duration” to Values. Edit the field settings to be “Count” and rename to “Number of Meetings”</li>
<li>Drag “Duration” to Values. Edit the field settings to be “Sum” and rename to “Total Duration”</li>
<li>Create two new fields – one with the amount of work weeks per year (48.775 for mine) and the amount of hours per week (40 for mine).</li>
<li>Create a new table for utilization percentages. Put the formula as <code>=C5/($E$5*$E$9*60)</code>.</li>
</ol>
<img src="/2014/11/27/Meeting-Room-Utilization/meetingroom.png" alt="meetingroom.png" title="">
                    
                        

                    
                    
                        <p>
                            <a href="/2014/11/27/Meeting-Room-Utilization/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/06/25/Get-MailboxSizes/">
                            Get-MailboxSizes
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-06-25T10:02:00+10:00">
	
		    Jun 25, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>This script produces a simple report to get the mailbox, archive and total sizes in a mailbox database. This helps with estimating space needed for mailbox moves.</p>
<script src="https://gist.github.com/jacobludriks/b095e2be224aa707145b.js"></script>

<p>To use, just load it up then use <code>Get-MailboxSizes -Database DBName</code>.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/06/25/Get-MailboxSizes/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/06/06/Getting-mailbox-database-sizes/">
                            Getting mailbox database sizes
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-06-06T17:54:00+10:00">
	
		    Jun 06, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>I’m not too sure why this isn’t exposed through the Exchange cmdlets, but here we go.</p>
<script src="https://gist.github.com/jacobludriks/b35790b4fef45ad11b21.js"></script>

<p>Run with <code>Get-DatabaseSize -Database DatabaseName</code> and it will return the database name, server, and database size in megabytes.</p>
<p>EDIT: well, it turns out you can just use <code>Get-MailboxDatabase -Database DatabaseName -Status | select name,server,databasesize</code>. Rookie error on my part.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/06/06/Getting-mailbox-database-sizes/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/06/02/meetingroomhud/">
                            meetingroomhud
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-06-02T14:20:00+10:00">
	
		    Jun 02, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>I’ve just pushed a little project to GitHub. It uses Powershell, Exchange EWS API and D3 to make a little timeline of calendar appointments for meeting rooms.</p>
<p><a href="https://github.com/jacobludriks/meetingroomhud" target="_blank" rel="external">https://github.com/jacobludriks/meetingroomhud</a></p>
<p>Feel free to give it a try and see if you hit any bugs.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/06/02/meetingroomhud/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/05/12/Member-count-of-distribution-lists/">
                            Member count of distribution lists
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-05-12T14:03:00+10:00">
	
		    May 12, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>I am looking at enabling certain features of mailing lists depending on how many users there are. The following script generates this report with group recursion.</p>
<script src="https://gist.github.com/jacobludriks/ceb99cdfaf6bb427d3d6.js"></script>

<p>By default it outputs to grouplisting.csv in the same folder you run the script from.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/05/12/Member-count-of-distribution-lists/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/05/12/Disabling-calendar-and-tasks-archiving-in-Exchange-2013/">
                            Disabling calendar and tasks archiving in Exchange 2013
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-05-12T11:49:00+10:00">
	
		    May 12, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>In our Exchange 2013 environment we have a few users who have tasks that can occur once every 5-10 years. Unfortunately this doesn’t sit well with our retention policies and they get moved down to the archive mailbox. To disable them from getting archived, create a DWORD Value in <code>HKLM\SYSTEM\CurrentControlSet\Services\MSExchangeMailboxAssistants\Parameters</code> called <code>ELCAssistantCalendarTaskRetentionEnabled</code> and make sure it is set to <code>0</code>.</p>
<p>Restart the <code>MSExchangeMailboxAssistants</code> service after making this change.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/05/12/Disabling-calendar-and-tasks-archiving-in-Exchange-2013/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2014/04/28/TokenMungingException-in-Exchange-OWA/">
                            TokenMungingException in Exchange OWA
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-04-28T13:48:00+10:00">
	
		    Apr 28, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>I’ve been busily rolling out Exchange 2013 SP1 at work and I’ve finally gotten to the stage where I can start migrating mailboxes over. Lo and behold, the fourth mailbox moved over had a strange issue whilst trying to access OWA:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">something went wrong</div><div class="line"></div><div class="line">Sorry, we can&apos;t get that information right now. Please try again later. If the problem persists, contact your helpdesk.</div><div class="line"></div><div class="line">X-OWA-Error: Microsoft.Exchange.Security.Authentication.TokenMungingException</div><div class="line">X-OWA-Version: 15.0.847.32</div><div class="line">X-FEServer: MAIL2013-1</div><div class="line">X-BEServer: Mail2013-2</div><div class="line">Date: 28/04/2014 11:35:42 AM</div></pre></td></tr></table></figure>
<p>It turns out that some users had a “LinkedMasterAccount” attribute set to “NT AUTHORITY\SELF” that didn’t need to be. The script to check all users with this attribute set:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Get-User -ResultSize unlimited | where &#123;$_.linkedmasteraccount -eq &quot;NT AUTHORITY\SELF&quot; -and $_.recipienttypedetails -ne &quot;RoomMailbox&quot; -and $_.recipienttypedetails -ne &quot;Equipmentmailbox&quot; -and $_.recipienttypedetails -ne &quot;DiscoveryMailbox&quot;&#125; | select name | ft</div></pre></td></tr></table></figure>
<p>This will spit out all accounts that aren’t room, equipment or discovery mailboxes with the LinkedMasterAccount set to “NT AUTHORITY\SELF”. From there, you can change it to $null with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Set-User -Identity &lt;user&gt; -LinkedMasterAccount $null</div></pre></td></tr></table></figure>
<p>After setting this the user was able to log in.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2014/04/28/TokenMungingException-in-Exchange-OWA/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jacob Ludriks. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <h4 id="about-card-name">Jacob Ludriks</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-xzfezjobyekpxrjktw5tz6muvzqfsbmo5n6atk3p5om9ulfptldi3p7cyqd8.min.js"></script>
<!--SCRIPTS END-->



    </body>
</html>
